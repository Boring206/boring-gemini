============================= test session starts =============================
platform win32 -- Python 3.12.6, pytest-9.0.2, pluggy-1.6.0 -- C:\Python312\python.exe
cachedir: .pytest_cache
rootdir: D:\User\Desktop\ralphgeminicode\boring-gemini
configfile: pyproject.toml
testpaths: tests
plugins: anyio-4.11.0, Faker-38.0.0, asyncio-1.3.0, cov-7.0.0, mock-3.15.1
asyncio: mode=Mode.AUTO, debug=False, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function
collecting ... collected 86 items / 84 deselected / 2 selected
run-last-failure: rerun previous 2 failures (skipped 32 files)

tests/unit/test_main_cli.py::test_dashboard_success FAILED               [ 50%]
tests/unit/test_main_cli.py::test_dashboard_subprocess_error FAILED      [100%]
ERROR: Coverage failure: total of 11 is less than fail-under=39


================================== FAILURES ===================================
___________________________ test_dashboard_success ____________________________
tests\unit\test_main_cli.py:531: in test_dashboard_success
    assert result.exit_code == 0
E   AssertionError: assert 1 == 0
E    +  where 1 = <Result ValueError('streamlit.__spec__ is not set')>.exit_code
_______________________ test_dashboard_subprocess_error _______________________
tests\unit\test_main_cli.py:543: in test_dashboard_subprocess_error
    assert "Failed to launch dashboard" in result.stdout
E   AssertionError: assert 'Failed to launch dashboard' in ''
E    +  where '' = <Result ValueError('streamlit.__spec__ is not set')>.stdout
============================== warnings summary ===============================
src\boring\models.py:35
  D:\User\Desktop\ralphgeminicode\boring-gemini\src\boring\models.py:35: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    class CircuitBreakerState(BaseModel):

src\boring\models.py:65
  D:\User\Desktop\ralphgeminicode\boring-gemini\src\boring\models.py:65: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    class LoopStatus(BaseModel):

C:\Users\User\AppData\Roaming\Python\Python312\site-packages\pydantic\_internal\_generate_schema.py:319
  C:\Users\User\AppData\Roaming\Python\Python312\site-packages\pydantic\_internal\_generate_schema.py:319: PydanticDeprecatedSince20: `json_encoders` is deprecated. See https://docs.pydantic.dev/2.12/concepts/serialization/#custom-serializers for alternatives. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    warnings.warn(

src\boring\models.py:81
  D:\User\Desktop\ralphgeminicode\boring-gemini\src\boring\models.py:81: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    class CircuitBreakerHistoryEntry(BaseModel):

src\boring\models.py:99
  D:\User\Desktop\ralphgeminicode\boring-gemini\src\boring\models.py:99: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    class Workflow(BaseModel):

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=============================== tests coverage ================================
_______________ coverage: platform win32, python 3.12.6-final-0 _______________

Name                                         Stmts   Miss Branch BrPart  Cover   Missing
----------------------------------------------------------------------------------------
src\boring\__init__.py                           0      0      0      0   100%
src\boring\agents\__init__.py                    6      6      0      0     0%   12-18
src\boring\agents\architect.py                  35     35     14      0     0%   13-173
src\boring\agents\base.py                      114    114     24      0     0%   10-295
src\boring\agents\coder.py                      94     94     42      0     0%   13-279
src\boring\agents\orchestrator.py              126    126     52      0     0%   10-342
src\boring\agents\reviewer\__init__.py           3      3      0      0     0%   5-8
src\boring\agents\reviewer\agent.py             46     46     12      0     0%   5-133
src\boring\agents\reviewer\orchestrator.py      39     39     16      0     0%   5-98
src\boring\agents\reviewer\parsers.py           27     27     12      0     0%   5-47
src\boring\agents\reviewer\prompts.py            2      2      0      0     0%   5-79
src\boring\audit.py                             69     49     18      0    23%   36-39, 44-48, 52, 56, 76-94, 98-109, 113-125, 141-165
src\boring\auto_fix.py                          58     41     14      0    24%   41-44, 57-130, 140-150, 173-206
src\boring\backup.py                            60     47     22      0    16%   21-25, 32-65, 71-85, 92-109
src\boring\brain_manager.py                    126    126     26      0     0%   18-434
src\boring\cache.py                             71     52     10      0    23%   20-23, 27-33, 37-40, 44-72, 76-80, 84-93, 97-103, 107-111
src\boring\circuit.py                           84     52     20      0    31%   56-70, 75-82, 87-88, 100-147, 152-153, 158-165, 170-180
src\boring\cli_client.py                       142    110     38      0    18%   54-68, 76, 80, 85, 90, 105-164, 182-193, 199-213, 226-229, 233-273, 279-310, 321-328, 333, 343-368
src\boring\config.py                           110     43     46      7    50%   32->31, 33->32, 38-45, 123-148, 155, 160-165, 175-181, 189-191, 201, 205->exit
src\boring\constants.py                         43     43      0      0     0%   7-93
src\boring\context_selector.py                 127    127     40      0     0%   13-426
src\boring\core.py                               9      9      0      0     0%   18-73
src\boring\dashboard.py                        111    111     34      0     0%   1-180
src\boring\debugger.py                          78     64     20      0    14%   23-26, 32-47, 53-118, 122-131, 139-157
src\boring\diff_patcher.py                      91     91     34      0     0%   13-288
src\boring\error_diagnostics.py                 82     82     34      0     0%   8-329
src\boring\exceptions.py                        84     84      2      0     0%   7-196
src\boring\extensions.py                       146    114     42      0    17%   78-80, 84, 88-105, 109-148, 152-160, 167-178, 192-213, 217-220, 224-241, 245-276, 284-296, 303-330, 338-426
src\boring\feedback_learner.py                  92     92     28      0     0%   8-193
src\boring\file_patcher.py                     163    145     72      0     8%   83-143, 150-172, 179-201, 219-263, 286-339, 355-371
src\boring\gemini_client.py                     10      3      0      0    70%   32-34
src\boring\health.py                           147    102     40      0    24%   57, 61, 65, 69, 74-90, 100-142, 149-160, 170-199, 206-232, 241-260, 267-274, 284-289, 304-333, 338-374
src\boring\hooks.py                             69     52     18      0    20%   152-154, 158, 162-187, 191-204, 208-221, 225-231, 235-249
src\boring\interactions_client.py               72     72     18      0     0%   13-228
src\boring\interactive.py                      217    217     68      0     0%   16-455
src\boring\interfaces.py                        78     23      6      0    65%   41, 47, 64, 81, 92-109, 125, 130, 135, 160, 165, 170, 194, 199
src\boring\judge\__init__.py                     4      0      0      0   100%
src\boring\judge\core.py                        89     73     22      0    14%   24-27, 41-71, 81-149, 163-214, 218, 222
src\boring\judge\factory.py                     12      6      4      0    38%   14-30
src\boring\judge\parsers.py                     24     19      8      0    16%   14-35
src\boring\judge\prompts.py                     31     25     10      0    15%   15-75, 120-131, 178-188
src\boring\limiter.py                           73     59     22      0    15%   25-37, 54-59, 72-74, 88, 100-124, 143-191
src\boring\llm\__init__.py                      17      6      4      0    52%   25-34
src\boring\llm\claude_adapter.py                55     36     12      0    28%   34-43, 47, 51, 61-62, 76-119, 125-136
src\boring\llm\executor.py                      54     45     18      0    12%   25-26, 42-65, 69-82, 86-107, 111-117
src\boring\llm\gemini.py                        78     59     28      0    18%   20-23, 38-65, 69, 73-75, 84-106, 115-168
src\boring\llm\ollama.py                        42     25      2      0    39%   25-27, 31, 35, 39, 44-48, 54-81, 96-97
src\boring\llm\openai_compat.py                 54     37      8      0    27%   26-29, 33, 37, 41, 46-55, 61-94, 104-105
src\boring\llm\provider.py                      19      5      0      0    74%   20, 26, 37, 48, 52
src\boring\llm\sdk.py                          140    121     56      0    10%   23-26, 69-111, 133-200, 213-237, 251-338, 349-353
src\boring\llm\tools.py                         12      6      2      0    43%   14-16, 73-76
src\boring\logger.py                            56     37     12      0    28%   65-103, 127-150, 164-173
src\boring\loop\__init__.py                      5      0      0      0   100%
src\boring\loop\agent.py                        96     72     30      0    19%   51-69, 73-109, 115-166, 171-190, 198-199, 211-232
src\boring\loop\base.py                         23      5      0      0    78%   42, 55, 69, 73, 77
src\boring\loop\context.py                      72     23      0      0    68%   85-96, 100, 104, 108, 112-114, 118, 122, 126, 130-131
src\boring\loop\legacy.py                      296    262     78      0     9%   51-97, 101-294, 299-305, 310-413, 425-498, 514-540, 545-553, 559-584, 590, 620-629, 636-662
src\boring\loop\states\__init__.py               5      0      0      0   100%
src\boring\loop\states\patching.py             134    117     56      0     9%   31, 35-41, 45-97, 102-111, 117-133, 137-178, 182-222, 226-240
src\boring\loop\states\recovery.py              61     45     12      0    22%   28, 32-37, 43-62, 67-75, 79-95, 110, 138, 158-159, 179-183, 187-200
src\boring\loop\states\thinking.py             159    138     52      0    10%   39, 43-45, 49-67, 73-106, 111-136, 140-142, 146-181, 185-242, 246-326, 330-343
src\boring\loop\states\verifying.py             76     59     18      0    18%   32, 36-38, 42-71, 76-105, 109-125, 129-138, 142-155
src\boring\main.py                             490    403    132      6    15%   76, 78, 80, 125-197, 205-224, 234, 242-243, 251-270, 279-293, 301-308, 328-334, 342-351, 362-373, 382-391, 403-427, 451-564, 569-587, 593-602, 618-632, 645-658, 674-765, 780-791, 797-807, 813-830, 841-867, 887-913, 927-950, 963-983, 993-1002, 1008-1017, 1023-1033, 1037
src\boring\mcp\__init__.py                       0      0      0      0   100%
src\boring\mcp\async_utils.py                   42     42      6      0     0%   10-130
src\boring\mcp\brain_tools.py                   40     40      6      0     0%   13-92
src\boring\mcp\core_tools.py                    37     37      2      0     0%   15-107
src\boring\mcp\http.py                          60     60      4      0     0%   13-139
src\boring\mcp\instance.py                       9      4      2      1    55%   5-7, 13
src\boring\mcp\interceptors.py                 103    103     26      0     0%   6-182
src\boring\mcp\prompts.py                       32     32      0      0     0%   9-154
src\boring\mcp\resources.py                     32     23     12      1    23%   4->exit, 9-20, 25-32, 37-46
src\boring\mcp\server.py                        68     68     14      0     0%   1-147
src\boring\mcp\speckit_tools.py                 27     27      0      0     0%   15-81
src\boring\mcp\tools\core.py                   125     99     32      1    17%   70-125, 176-229, 260-307, 325-348, 361-390, 408-422, 434->exit
src\boring\mcp\tools\evaluation.py             133    122     48      1     7%   49-250, 253->exit
src\boring\mcp\tools\git.py                    151    129     66      1    11%   32-72, 90-104, 122-135, 173-254, 288-342, 354->exit
src\boring\mcp\tools\integration.py             27     15      6      1    39%   35-64, 79, 104->exit
src\boring\mcp\tools\knowledge.py               50     35      8      1    28%   32-51, 72-86, 106-120, 123->exit
src\boring\mcp\tools\speckit.py                 87     57     28      1    27%   19-43, 48-52, 73-171, 204, 235, 271, 299, 325, 352, 355->exit
src\boring\mcp\tools\verification.py            67     55     26      1    14%   40-115, 147-211, 218->exit
src\boring\mcp\tools\workflow.py               113     86     28      1    20%   65-79, 101-115, 136-156, 178-192, 213-222, 246-258, 277-325, 328->exit
src\boring\mcp\utils.py                         84     63     34      0    18%   25-37, 64-96, 104-139, 147-159, 176-182
src\boring\mcp\v9_tools.py                      93     93      8      0     0%   9-361
src\boring\mcp\v10_tools.py                     34     34      0      0     0%   7-80
src\boring\memory.py                            98     59     18      0    34%   59-67, 71, 75, 80-94, 98, 102-128, 138-140, 144, 148, 152-165, 169-189
src\boring\models.py                            60      0      0      0   100%
src\boring\monitor.py                          138    138     32      0     0%   1-235
src\boring\pattern_mining.py                   135    135     64      0     0%   10-365
src\boring\plugins\__init__.py                   2      2      0      0     0%   10-12
src\boring\plugins\loader.py                   111    111     32      0     0%   12-233
src\boring\quality_tracker.py                   65     40     12      0    32%   31-34, 37, 41-57, 61-62, 66-95, 98-103, 106
src\boring\rag\__init__.py                       5      5      0      0     0%   22-27
src\boring\rag\code_indexer.py                 262    262    114      0     0%   21-603
src\boring\rag\graph_builder.py                138    138     72      0     0%   9-300
src\boring\rag\index_state.py                   65     65     14      0     0%   1-116
src\boring\rag\parser.py                        76     76     22      0     0%   8-247
src\boring\rag\rag_retriever.py                325    325    120      0     0%   12-743
src\boring\response_analyzer.py                116    105     46      0     7%   42-159, 164-204, 209-220
src\boring\rubrics.py                           27      2      0      0    93%   234, 239
src\boring\security.py                          89     69     34      0    16%   127-201, 206-207, 242-249, 254-257, 276-289, 303-310
src\boring\setup.py                            122    122     34      0     0%   1-320
src\boring\shadow_mode.py                      183    183     48      0     0%   12-498
src\boring\storage.py                          137     89     14      0    32%   63-68, 72-73, 132-142, 148-166, 170-180, 184-195, 201-225, 229-230, 241-253, 257-268, 272-284, 290-291, 301-313, 319-334, 347-358, 379-392, 407-414, 418-419, 423-434, 439-440
src\boring\streaming.py                         82     82      8      0     0%   10-207
src\boring\utils.py                             47     36     14      0    18%   20-28, 38-75, 80-89
src\boring\vector_memory.py                    106    106     32      0     0%   10-298
src\boring\verification\__init__.py              4      0      0      0   100%
src\boring\verification\config.py               27     24      6      0     9%   15-55
src\boring\verification\handlers.py            188    167     68      0     8%   20-39, 52-85, 95-123, 131-160, 168-196, 202-230, 238-266, 279-332, 340-374, 382-439, 450-480, 486-532, 540-569
src\boring\verification\test_runners.py         68     58     26      0    11%   11-52, 60-90, 102-132, 144-174, 186-216, 228-258
src\boring\verification\tools.py                23     13      0      0    43%   8-14, 20-46, 56, 60-65, 68, 71, 74
src\boring\verification\verifier.py            192    167     96      0     9%   26-35, 100-104, 110-114, 120-127, 133, 139-155, 159-196, 207-220, 225-235, 245-267, 277-361, 364-380
src\boring\vscode_server.py                    128    128     18      0     0%   8-248
src\boring\workflow_evolver.py                 113    113     28      0     0%   13-275
src\boring\workflow_manager.py                 155    117     42      0    19%   29-32, 48, 53-86, 98-104, 108-118, 123-125, 129-131, 144-171, 183-233, 247-297
src\boring\workspace.py                         84     84     22      0     0%   10-199
----------------------------------------------------------------------------------------
TOTAL                                         9793   8371   2800     23    11%
Coverage HTML written to dir htmlcov
FAIL Required test coverage of 39% not reached. Total coverage: 11.49%
=========================== short test summary info ===========================
FAILED tests/unit/test_main_cli.py::test_dashboard_success - AssertionError: assert 1 == 0
 +  where 1 = <Result ValueError('streamlit.__spec__ is not set')>.exit_code
FAILED tests/unit/test_main_cli.py::test_dashboard_subprocess_error - AssertionError: assert 'Failed to launch dashboard' in ''
 +  where '' = <Result ValueError('streamlit.__spec__ is not set')>.stdout
================ 2 failed, 84 deselected, 5 warnings in 6.23s =================
